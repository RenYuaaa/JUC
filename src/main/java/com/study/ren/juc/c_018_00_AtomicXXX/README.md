### CAS(无锁优化，自旋、乐观锁)
* CAS--CompareAndSwap，比较并替换
* CAS中包含：原值，期望值，新值
  * 当原值和期望值相等时，则会将原值替换为新值

### CAS问题
* ABA问题
  * 解决办法：
    * 加版本号，在比较原值和期望值的同时也去比较版本号是否相同
    * 利用AtomicStampedReference解决（加入了预期标志和更新后标志两个字段，更新时不光检查值，还要检查当前的标志是否等于预期标志，全部相等的话才会更新
* 循环时间长开销大：自旋CAS的方式如果长时间不成功，会给CPU带来很大的开销
* 只能保证一个共享变量的原子操作：只对一个共享变量操作可以保证原子性，但是多个则不行，多个可以通过AtomicReference来处理或者使用锁synchronized实现。

### volatile作用：
* 保证线程可见性
  * MESI，缓存一致性协议
* 禁止指令重排序

### 所有的CAS操作在Java中的支持使用的时Unsafe类